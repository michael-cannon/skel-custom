#!/bin/bash

# Prepare Testimonials Widget for release
#
# @author Michael Cannon <mc@aihr.us>

KEY="tw"

source ~/.skel/bin/custom/wpinit ${KEY}
echo

wppackage ${KEY} ${@} || exit 1;
wppush ${KEY}

# push svn and do WordPress release
cd ~/code/svn.wordpress
cd testimonials-widget
svn cleanup . || { echo "Unable to 'svn cleanup'"; exit 1; }
svn up --force || { echo "Unable to 'svn up --force'"; exit 1; }

if [[ ! -e "tags/${VERSION}" ]]
then
	svn cp trunk tags/${VERSION}
	svn ci -m "Release version ${VERSION}" || { echo "Unable to 'svn ci'"; exit 1; }
	svn status
else
	echo Manually merge SVN files
	echo "svn cp trunk tags/${VERSION}"
	echo "svn ci -m \"Release version ${VERSION}\""
	echo
fi

open http://wordpress.org/extend/plugins/about/validator/

mvim ${SITE_WP_PLUGINS}/testimonials-widget/changelog.txt
open http://aihr.us/wp-admin/post.php?post=16105\&action=edit

open http://testwp.localhost/wp-admin/update-core.php
open http://aihr.us/wp-admin/update-core.php
open http://wordpress.org/extend/plugins/testimonials-widget/

## for SCRIPT in ${SCRIPTS}
## do
## 	echo
## 	${SCRIPT}
## 	echo
## done